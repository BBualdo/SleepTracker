<back-button></back-button>
<div class="sessions__container">
  <h1>Sessions</h1>
  @if (sessions$ | async; as sessions) {
    <div class="sessions__box">
      <div class="sessions__panel">
        <button
          class="btn primary__btn"
          (click)="openFormDialog('add', 'Add Session')"
        >
          Add Session
        </button>
      </div>
      <div class="sessions__header">
        <span>No.</span>
        <span>Start Time</span>
        <span>End Time</span>
        <span>Duration</span>
        <span><mat-icon fontIcon="more_vert"></mat-icon></span>
      </div>

      <div class="sessions">
        @if (sessions.length > 0) {
          @for (session of paginatedSessions; track $index) {
            <div class="session">
              <span>{{ $index + 1 + pageSize * (currentPage - 1) }}</span>
              <span>{{
                formatDate(session.startTime, "dd.MM.yyyy HH:mm", "en-US")
              }}</span>
              <span>{{
                formatDate(session.endTime, "dd.MM.yyyy HH:mm", "en-US")
              }}</span>
              <span>{{ getDuration(session.durationInMinutes) }}</span>
              <div class="buttons">
                <button
                  class="edit__btn"
                  (click)="openFormDialog('update', 'Update Session', session)"
                >
                  <mat-icon fontIcon="edit"></mat-icon>
                </button>
                <button class="delete__btn" (click)="confirmDelete(session)">
                  <mat-icon fontIcon="delete"></mat-icon>
                </button>
              </div>
            </div>
          }
        } @else {
          <p class="no-sessions">No sessions yet.</p>
        }
      </div>
      <div
        class="sessions__paginator"
        [ngClass]="{ hidden: paginatedSessions.length == 0 }"
      >
        <button [disabled]="currentPage === 1" (click)="previousPage()">
          <mat-icon fontIcon="chevron_left"></mat-icon>
        </button>
        <p>Page {{ currentPage }} of {{ pagesAmount }}</p>
        <button [disabled]="currentPage === pagesAmount" (click)="nextPage()">
          <mat-icon fontIcon="chevron_right"></mat-icon>
        </button>
      </div>
    </div>
  } @else {
    <div class="spinner">
      <mat-spinner></mat-spinner>
    </div>
  }
</div>
